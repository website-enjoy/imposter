<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>لعبة المحتال | Imposter Game</title>
    <style>
        :root {
            --primary: #6366f1;
            --primary-light: #818cf8;
            --primary-dark: #4f46e5;
            --secondary: #ec4899;
            --secondary-light: #f472b6;
            --bg: #0b0f1a;
            --surface: #161c2d;
            --surface-hover: #1e293b;
            --text: #ffffff;
            --text-muted: #94a3b8;
            --border: rgba(255, 255, 255, 0.08);
            --radius-xl: 32px;
            --radius-lg: 24px;
            --radius-md: 16px;
            --shadow-lg: 0 20px 25px -5px rgba(0, 0, 0, 0.3), 0 10px 10px -5px rgba(0, 0, 0, 0.1);
            --safe-top: env(safe-area-inset-top, 20px);
            --safe-bottom: env(safe-area-inset-bottom, 20px);
        }

        * {
            box-sizing: border-box;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
            margin: 0;
            padding: 0;
            outline: none;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
            background-color: var(--bg);
            color: var(--text);
            overflow: hidden;
            height: 100vh;
            width: 100vw;
            display: flex;
            justify-content: center;
            align-items: center;
            overscroll-behavior: none;
            touch-action: manipulation;
            line-height: 1.5;
        }

        html {
            height: 100%;
            overscroll-behavior: none;
        }

        #app {
            width: 100%;
            height: 100%;
            max-width: 450px;
            position: relative;
            background:
                radial-gradient(circle at -20% -20%, rgba(99, 102, 241, 0.15), transparent 50%),
                radial-gradient(circle at 120% 120%, rgba(236, 72, 153, 0.1), transparent 50%);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .screen {
            position: absolute;
            inset: 0;
            display: none;
            flex-direction: column;
            padding: calc(var(--safe-top) + 16px) 16px calc(var(--safe-bottom) + 16px);
            opacity: 0;
            transform: scale(0.98) translateY(10px);
            transition: all 0.5s cubic-bezier(0.16, 1, 0.3, 1);
            z-index: 1;
            /* Allow scrolling only if the screen height is extremely small */
            overflow-y: auto;
            overflow-x: hidden;
        }

        .screen.active {
            display: flex;
            opacity: 1;
            transform: scale(1) translateY(0);
            z-index: 2;
        }

        h1 {
            font-size: 1.8rem;
            font-weight: 900;
            margin-bottom: 2px;
            background: linear-gradient(135deg, #fff 0%, var(--primary-light) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-align: center;
        }

        p.subtitle {
            color: var(--text-muted);
            font-size: 0.9rem;
            margin-bottom: 8px;
            text-align: center;
        }

        .card-group {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: var(--radius-md);
            padding: 8px 12px;
            margin-bottom: 8px;
            box-shadow: var(--shadow-lg);
        }

        .section-label {
            font-size: 0.75rem;
            font-weight: 700;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 6px;
            display: block;
        }

        .control-row {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .number-badge {
            width: 32px;
            height: 32px;
            background: var(--surface-hover);
            border: 1px solid var(--border);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
            font-weight: 800;
            color: var(--primary-light);
        }

        input[type="range"] {
            flex: 1;
            -webkit-appearance: none;
            height: 6px;
            background: var(--surface-hover);
            border-radius: 3px;
            outline: none;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 24px;
            height: 24px;
            background: var(--primary);
            border: 3px solid var(--surface);
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 0 15px rgba(99, 102, 241, 0.4);
        }

        .chip-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 6px;
        }

        .chip-grid.categories {
            display: flex;
            overflow-x: auto;
            gap: 6px;
            padding-bottom: 4px;
            /* for scrollbar */
            white-space: nowrap;
            -webkit-overflow-scrolling: touch;
        }

        .chip-grid.categories::-webkit-scrollbar {
            display: none;
        }

        .chip {
            background: var(--surface-hover);
            padding: 6px 12px;
            border-radius: var(--radius-md);
            border: 1px solid var(--border);
            color: var(--text-muted);
            font-size: 0.85rem;
            font-weight: 600;
            text-align: center;
            transition: all 0.2s;
            cursor: pointer;
            flex-shrink: 0;
        }

        .chip.active {
            background: var(--primary);
            border-color: var(--primary-light);
            color: white;
            box-shadow: 0 8px 20px rgba(99, 102, 241, 0.25);
        }

        .btn-main {
            padding: 14px;
            border-radius: var(--radius-lg);
            font-size: 1.15rem;
            font-weight: 800;
            border: none;
            cursor: pointer;
            width: 100%;
            margin-top: auto;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            box-shadow: 0 10px 25px rgba(99, 102, 241, 0.4);
        }

        .btn-primary:active {
            transform: scale(0.97);
        }

        .btn-secondary {
            background: var(--surface);
            color: var(--text);
            border: 1px solid var(--border);
            font-size: 1rem;
            padding: 16px;
        }

        .player-indicator {
            width: 100px;
            height: 100px;
            background: linear-gradient(135deg, var(--surface), var(--surface-hover));
            border: 3px solid var(--primary);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3.5rem;
            font-weight: 900;
            color: var(--primary-light);
            margin: 20px auto;
            position: relative;
            box-shadow: 0 0 40px rgba(99, 102, 241, 0.3);
            text-shadow: 0 0 20px rgba(99, 102, 241, 0.5);
        }

        .player-indicator::before {
            content: '';
            position: absolute;
            top: -10px;
            right: -10px;
            bottom: -10px;
            left: -10px;
            border-radius: 50%;
            border: 2px solid var(--primary-light);
            opacity: 0.5;
            animation: pulseAvatar 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }

        @keyframes pulseAvatar {
            0% {
                transform: scale(1);
                opacity: 0.8;
            }

            100% {
                transform: scale(1.3);
                opacity: 0;
            }
        }

        .fade-in-up {
            animation: fadeInUp 0.6s cubic-bezier(0.16, 1, 0.3, 1) forwards;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .role-reveal-scene {
            width: 100%;
            flex: 1;
            min-height: 180px;
            max-height: 250px;
            perspective: 1000px;
            /* Enable 3D space */
            margin-bottom: 12px;
        }

        .role-reveal-box {
            width: 100%;
            height: 100%;
            position: relative;
            transition: transform 0.6s cubic-bezier(0.4, 0.0, 0.2, 1);
            transform-style: preserve-3d;
            box-shadow: var(--shadow-lg);
            border-radius: var(--radius-lg);
            cursor: pointer;
        }

        .role-reveal-box.flipped {
            transform: rotateY(180deg);
        }

        .card-face {
            position: absolute;
            width: 100%;
            height: 100%;
            -webkit-backface-visibility: hidden;
            backface-visibility: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            border-radius: var(--radius-lg);
            border: 1px solid var(--border);
            overflow: hidden;
        }

        .card-front {
            background: rgba(22, 28, 45, 0.95);
            background-image: repeating-linear-gradient(45deg, rgba(255, 255, 255, 0.03) 0px, rgba(255, 255, 255, 0.03) 2px, transparent 2px, transparent 8px);
        }

        .pulse-icon {
            width: 60px;
            height: 60px;
            background: var(--surface-hover);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 16px;
            animation: pulseGlow 2s infinite;
        }

        @keyframes pulseGlow {
            0% {
                box-shadow: 0 0 0 0 rgba(99, 102, 241, 0.4);
                transform: scale(0.95);
            }

            70% {
                box-shadow: 0 0 0 15px rgba(99, 102, 241, 0);
                transform: scale(1);
            }

            100% {
                box-shadow: 0 0 0 0 rgba(99, 102, 241, 0);
                transform: scale(0.95);
            }
        }

        .card-back {
            background: radial-gradient(circle at center, var(--surface-hover), var(--surface));
            transform: rotateY(180deg);
        }

        .role-reveal-box.revealed {
            background: radial-gradient(circle at center, var(--surface-hover), var(--surface));
        }

        .word-anim {
            font-size: 3rem;
            font-weight: 950;
            text-align: center;
            animation: popIn 0.5s cubic-bezier(0.17, 0.67, 0.83, 0.67);
        }

        @keyframes popIn {
            0% {
                transform: scale(0.8) translateY(20px);
                opacity: 0;
            }

            100% {
                transform: scale(1) translateY(0);
                opacity: 1;
            }
        }

        .results-container {
            flex: 1;
            background: rgba(0, 0, 0, 0.2);
            border-radius: var(--radius-lg);
            padding: 12px;
            overflow-y: auto;
            margin: 20px 0;
        }

        .res-item {
            background: var(--surface);
            border-radius: var(--radius-md);
            padding: 16px;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border-right: 4px solid transparent;
        }

        .res-item.imposter {
            border-right-color: var(--secondary);
            background: rgba(236, 72, 153, 0.05);
        }

        .p-num {
            font-size: 0.8rem;
            color: var(--text-muted);
            margin-bottom: 4px;
            display: block;
        }

        .p-name {
            font-weight: 700;
            font-size: 1.1rem;
        }

        .p-wrd {
            font-weight: 800;
            color: var(--primary-light);
        }

        .hidden {
            display: none !important;
        }

        /* Animation for shake */
        .shake {
            animation: shakeEffect 0.5s ease-in-out;
        }

        @keyframes shakeEffect {

            0%,
            100% {
                transform: translateX(0);
            }

            20%,
            60% {
                transform: translateX(-5px);
            }

            40%,
            80% {
                transform: translateX(5px);
            }
        }

        /* New Game Mechanics Styles */
        .toggle-row {
            background: var(--surface-hover);
            padding: 6px 10px;
            border-radius: var(--radius-md);
            border: 1px solid var(--border);
            display: flex;
            align-items: center;
            cursor: pointer;
        }

        .toggle-switch {
            appearance: none;
            width: 48px;
            height: 24px;
            background: var(--surface);
            border-radius: 12px;
            position: relative;
            cursor: pointer;
            outline: none;
            border: 1px solid var(--border);
            transition: all 0.3s;
        }

        .toggle-switch::after {
            content: '';
            position: absolute;
            top: 2px;
            left: 2px;
            width: 18px;
            height: 18px;
            background: var(--text-muted);
            border-radius: 50%;
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .toggle-switch:checked {
            background: var(--primary);
            border-color: var(--primary-light);
        }

        .toggle-switch:checked::after {
            transform: translateX(24px);
            background: white;
        }

        /* End 3D Flip Mechanics */

        .role-word.imposter-text {
            color: var(--secondary);
        }

        .role-word.spy-text {
            color: var(--spy-color, #10b981);
        }

        .role-word.blind-text {
            color: var(--blind-color, #64748b);
        }

        .voting-item {
            background: var(--surface);
            border-radius: var(--radius-md);
            padding: 16px;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            border: 2px solid transparent;
            transition: all 0.2s;
            cursor: pointer;
        }

        .voting-item.selected {
            border-color: var(--primary);
            background: rgba(99, 102, 241, 0.1);
            transform: scale(1.02);
        }

        .voting-item .p-name {
            font-size: 1.2rem;
            font-weight: 800;
            margin-right: auto;
        }

        .voting-item .p-num {
            color: var(--text-muted);
            font-size: 0.9rem;
            margin-left: 16px;
        }

        /* Home Button */
        .btn-home {
            position: fixed;
            top: env(safe-area-inset-top, 20px);
            right: 20px;
            height: 44px;
            padding: 0 16px;
            border-radius: 22px;
            background: rgba(22, 28, 45, 0.8);
            backdrop-filter: blur(8px);
            border: 1px solid var(--border);
            color: var(--text);
            font-size: 1rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 100;
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        .btn-home:hover {
            background: var(--surface-hover);
            transform: scale(1.1);
        }

        .btn-home:active {
            transform: scale(0.9);
        }

        /* Discussion Timer */
        .timer-display {
            font-size: 3.5rem;
            font-weight: 950;
            font-variant-numeric: tabular-nums;
            color: var(--text);
            text-shadow: 0 0 20px rgba(255, 255, 255, 0.2);
            margin: 20px 0;
            transition: color 0.3s, transform 0.1s;
        }

        .timer-display.running {
            color: var(--primary-light);
            text-shadow: 0 0 30px rgba(99, 102, 241, 0.5);
        }

        .timer-display.warning {
            color: var(--secondary);
            animation: pulseTimer 1s infinite alternate;
            text-shadow: 0 0 30px rgba(236, 72, 153, 0.7);
        }

        @keyframes pulseTimer {
            0% {
                transform: scale(1);
            }

            100% {
                transform: scale(1.05);
            }
        }

        .timer-controls {
            display: flex;
            gap: 12px;
            margin-bottom: 20px;
            width: 100%;
        }

        .btn-half {
            flex: 1;
            padding: 12px;
            border-radius: var(--radius-md);
            font-size: 1rem;
            font-weight: 700;
            border: none;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn-danger {
            background: rgba(236, 72, 153, 0.15);
            color: var(--secondary-light);
            border: 1px solid rgba(236, 72, 153, 0.3);
        }

        .btn-danger:active {
            background: rgba(236, 72, 153, 0.3);
            transform: scale(0.97);
        }

        .btn-success {
            background: rgba(16, 185, 129, 0.15);
            color: #34d399;
            border: 1px solid rgba(16, 185, 129, 0.3);
        }

        .btn-success:active {
            background: rgba(16, 185, 129, 0.3);
            transform: scale(0.97);
        }
    </style>
</head>

<body>
    <div id="app">
        <button id="home-btn" class="btn-home hidden" aria-label="العودة للقائمة الرئيسية">العودة</button>

        <!-- Start Screen -->
        <div id="screen-start" class="screen active">
            <header>
                <h1>زلاط المحتال</h1>
                <p class="subtitle">لعبة ذكاء، خداع، وتحليل</p>
            </header>

            <div class="card-group">
                <span class="section-label">وقت النقاش</span>
                <div class="control-row">
                    <input type="range" id="time-slider" min="30" max="180" step="10" value="60">
                    <div id="time-value" class="number-badge">60ث</div>
                </div>
            </div>

            <div class="card-group">
                <span class="section-label">عدد اللاعبين</span>
                <div class="control-row">
                    <input type="range" id="players-slider" min="3" max="15" value="4">
                    <div id="players-value" class="number-badge">4</div>
                </div>
            </div>

            <div class="card-group">
                <span class="section-label">عدد المحتالين</span>
                <div class="control-row">
                    <input type="range" id="imposters-slider" min="1" max="3" value="1">
                    <div id="imposters-value" class="number-badge">1</div>
                </div>
            </div>

            <div class="card-group">
                <span class="section-label">نمط اللعب</span>
                <div class="chip-grid" id="mode-selector">
                    <div class="chip active" data-mode="classic">كلاسيكي</div>
                    <div class="chip" data-mode="hard">صعب (Hard)</div>
                </div>
            </div>

            <div class="card-group">
                <span class="section-label">الأدوار الإضافية</span>
                <div class="role-toggles" style="display: flex; gap: 6px; flex-direction: column;">
                    <label class="toggle-row">
                        <span class="toggle-label"
                            style="display: flex; align-items: center; justify-content: space-between; width: 100%;">
                            <span>الجاسوس (Spy)</span>
                            <input type="checkbox" id="spy-toggle" class="toggle-switch">
                        </span>
                    </label>
                    <label class="toggle-row">
                        <span class="toggle-label"
                            style="display: flex; align-items: center; justify-content: space-between; width: 100%;">
                            <span>الأعمى (Blind)</span>
                            <input type="checkbox" id="blind-toggle" class="toggle-switch">
                        </span>
                    </label>
                </div>
            </div>

            <div class="card-group">
                <span class="section-label">التصنيفات</span>
                <div class="chip-grid categories" id="category-selector">
                    <div class="chip active" data-cat="all">الكل</div>
                    <div class="chip" data-cat="food">طعام</div>
                    <div class="chip" data-cat="animals">حيوانات</div>
                    <div class="chip" data-cat="objects">أدوات</div>
                    <div class="chip" data-cat="sports">رياضة</div>
                    <div class="chip" data-cat="funny">مضحك</div>
                    <div class="chip" data-cat="body">جسم</div>
                    <div class="chip" data-cat="places">مدن/دول</div>
                    <div class="chip" data-cat="jobs">مهن</div>
                </div>
            </div>

            <button class="btn-main btn-primary" id="start-btn">ابدأ اللعبة</button>
        </div>

        <!-- Pass Phone Screen -->
        <div id="screen-pass" class="screen">
            <header class="fade-in-up" style="animation-delay: 0.1s;">
                <p class="subtitle" style="font-size: 1.1rem;">مرر الهاتف إلى</p>
            </header>

            <div class="player-indicator fade-in-up" id="current-player-display" style="animation-delay: 0.2s;">1</div>

            <p class="subtitle fade-in-up" style="margin-top: 10px; font-size: 1.2rem; animation-delay: 0.3s;">جاهز يا
                لاعب؟</p>
            <p class="fade-in-up"
                style="color: var(--text-muted); font-size: 0.95rem; text-align: center; margin-top: 5px; animation-delay: 0.4s;">
                تأكد أن لا أحد يرى الشاشة!</p>

            <button class="btn-main btn-primary fade-in-up" id="im-ready-btn"
                style="margin-top: auto; animation-delay: 0.5s;">أنا مستعد</button>
        </div>

        <!-- Reveal Screen -->
        <div id="screen-reveal" class="screen">
            <header>
                <p class="subtitle" id="reveal-instruction">انقر للقلب والكشف عن دورك</p>
            </header>

            <div class="role-reveal-scene">
                <div class="role-reveal-box" id="reveal-card">

                    <!-- Front of Card (Unrevealed) -->
                    <div class="card-face card-front" id="card-front-face">
                        <div class="pulse-icon">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="var(--primary-light)"
                                stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M15 3h6v6"></path>
                                <path d="M9 21H3v-6"></path>
                                <path d="M21 3l-7 7"></path>
                                <path d="M3 21l7-7"></path>
                            </svg>
                        </div>
                        <div id="role-initial-text"
                            style="color: var(--text-muted); font-size: 1.3rem; font-weight: 700;">اضغط للقلب</div>
                    </div>

                    <!-- Back of Card (Revealed) -->
                    <div class="card-face card-back" id="card-back-face">
                        <div id="role-category"
                            style="color: var(--primary-light); font-weight: 800; font-size: 1rem; margin-bottom: 4px;">
                        </div>
                        <div id="role-title" style="color: var(--text-muted); font-size: 0.9rem;">أنت</div>
                        <div id="role-word" class="role-word word-anim">...</div>
                        <div id="role-word-desc"
                            style="color: var(--text-muted); font-size: 0.9rem; margin-top: 4px; text-align: center; padding: 0 16px; font-weight: 600; display: none;">
                        </div>
                        <div id="role-subtext"
                            style="color: var(--text-muted); font-size: 0.85rem; margin-top: 8px; display: none; text-align: center; padding: 0 10px;">
                        </div>
                    </div>

                </div>
            </div>

            <button class="btn-main btn-primary hidden" id="done-reveal-btn">التالي</button>
        </div>

        <!-- Voting/Game Context Screen -->
        <div id="screen-game" class="screen">
            <header>
                <h1>مرحلة النقاش</h1>
                <p class="subtitle">من هو المحتال؟ تناقشوا الآن</p>
            </header>

            <div class="card-group text-center">
                <span class="section-label">تلميح اللعبة</span>
                <div id="game-word-hint" style="font-size: 2rem; font-weight: 950; color: var(--primary-light);">؟؟؟؟
                </div>
            </div>

            <div class="card-group text-center"
                style="display: flex; flex-direction: column; align-items: center; justify-content: center; flex: 1;">
                <span class="section-label">الوقت المتبقي</span>
                <div id="discussion-timer" class="timer-display">00:00</div>
                <div class="timer-controls">
                    <button class="btn-half btn-success" id="start-timer-btn"> بدء</button>
                    <button class="btn-half btn-danger" id="stop-timer-btn" disabled> إيقاف</button>
                </div>
            </div>

            <button class="btn-main btn-primary" id="start-voting-btn">انتقال للتصويت</button>
        </div>

        <!-- Voting Screen -->
        <div id="screen-voting" class="screen">
            <header>
                <h1>مرحلة التصويت</h1>
                <p class="subtitle">صوّت للاعب الذي تعتقد أنه المحتال</p>
            </header>

            <div class="results-container" id="voting-list">
                <!-- Players dynamic here -->
            </div>

            <button class="btn-main btn-primary hidden" id="confirm-vote-btn">تأكيد التصويت</button>
        </div>

        <!-- Voting Reveal Screen -->
        <div id="screen-voting-reveal" class="screen">
            <header>
                <h1>نتيجة التصويت</h1>
            </header>

            <div class="card-group text-center" style="margin: 30px 0;">
                <div id="voting-result-title" style="font-size: 2rem; font-weight: 900; margin-bottom: 10px;">...</div>
                <div id="voting-result-text" style="color: var(--text-muted); font-size: 1.1rem;">...</div>
            </div>

            <button class="btn-main btn-primary" id="next-phase-btn">التالي</button>
        </div>

        <!-- Spy Guessing Screen -->
        <div id="screen-spy-guess" class="screen">
            <header>
                <h1>مرحلة الجاسوس</h1>
                <p class="subtitle">أيها الجاسوس، خمن الكلمة لتفوز!</p>
            </header>

            <div class="card-group">
                <span class="section-label">اختر الكلمة الصحيحة</span>
                <div class="chip-grid categories" id="spy-word-options">
                    <!-- Options dynamic here -->
                </div>
            </div>

            <button class="btn-main btn-primary" id="spy-confirm-btn" disabled>تأكيد الاختيار</button>
        </div>

        <!-- Results Screen -->
        <div id="screen-results" class="screen">
            <header>
                <h1 id="win-title">النتائج</h1>
                <p class="subtitle" id="win-subtitle">...</p>
            </header>

            <div class="card-group" style="padding: 16px;" id="res-words-container">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <div>
                        <span class="section-label" style="margin:0;">الكلمة الأصلية</span>
                        <div id="res-original-word"
                            style="font-weight: 800; font-size: 1.2rem; color: var(--primary-light);">...</div>
                    </div>
                    <div id="res-fake-word-group" style="display: none; text-align: left;">
                        <span class="section-label" style="margin:0;">الكلمة المزيفة</span>
                        <div id="res-fake-word" style="font-weight: 800; font-size: 1.2rem; color: var(--secondary);">
                            ...</div>
                    </div>
                </div>
            </div>

            <div class="results-container" id="results-list">
                <!-- Results dynamic here -->
            </div>

            <button class="btn-main btn-primary" id="restart-btn">لعب مرة أخرى</button>
        </div>
    </div>

    <script>
        // --- Word Database ---
        const wordDatabase = [
            // --- FOOD (الماكلة) ---
            { cat: 'food', w1: 'كسكس', d1: 'أكلة جزائرية تقليدية من السميد', w2: 'شخشوخة', d2: 'أكلة تقليدية من العجين والمرق' },
            { cat: 'food', w1: 'مقرونة', d1: 'نوع من العجائن (معكرونة)', w2: 'سباغيتي', d2: 'معكرونة طويلة ورفيعة' },
            { cat: 'food', w1: 'دوبارة', d1: 'أكلة شعبية حارة بالحمص والفول', w2: 'لوبيا', d2: 'حبوب بيضاء تطبخ كمرق' },
            { cat: 'food', w1: 'عدس', d1: 'حبوب بنية غنية بالحديد', w2: 'حمص', d2: 'حبوب صفراء تستخدم في الطبخ' },
            { cat: 'food', w1: 'رفيس', d1: 'حلوى تقليدية من السميد والتمر', w2: 'بغرير', d2: 'فطائر مثقبة تسقى بالعسل' },
            { cat: 'food', w1: 'غريبة', d1: 'حلوى جافة تذوب في الفم', w2: 'مقروط', d2: 'حلوى مقلية محشوة بالتمر' },
            { cat: 'food', w1: 'فلان', d1: 'تحلية باردة بالبيض والحليب', w2: 'ياوورت', d2: 'حليب متخمر بنكهات مختلفة' },
            { cat: 'food', w1: 'شاورما', d1: 'لحم مشوي يلف في الخبز', w2: 'كباب', d2: 'لحم مفروم مشوي على السيخ' },
            { cat: 'food', w1: 'بيتزا', d1: 'عجينة دائرية مغطاة بالصلصة والجبن', w2: 'سندويش', d2: 'خبز محشو بمكونات مختلفة' },
            { cat: 'food', w1: 'خبز', d1: 'غذاء أساسي يصنع من الدقيق', w2: 'مطلوع', d2: 'خبز تقليدي يطهى في الطاجين' },
            { cat: 'food', w1: 'عصير', d1: 'مشروب مستخلص من الفواكه', w2: 'مشروب', d2: 'سائل يشرب للارتواء' },
            { cat: 'food', w1: 'طاجين', d1: 'طبق تقليدي يطبخ في الفخار', w2: 'مرقة', d2: 'صلصة سائلة تطبخ فيها الخضار' },
            { cat: 'food', w1: 'روز', d1: 'حبوب بيضاء صغيرة تطبخ كطبق', w2: 'فريك', d2: 'قمح أخضر مجروش لعمل الشوربة' },
            { cat: 'food', w1: 'سمك', d1: 'حيوان مائي يؤكل', w2: 'سردين', d2: 'نوع صغير وشائع من الأسماك' },
            { cat: 'food', w1: 'دجاج', d1: 'طائر يربى لأجل لحمه وبيضه', w2: 'لحم', d2: 'نسيج عضلي يؤكل من الحيوانات' },
            { cat: 'food', w1: 'بيض', d1: 'منتج الدجاج يستخدم بكثرة في الطبخ', w2: 'أومليت', d2: 'بيض مخفوق ومقلي' },
            { cat: 'food', w1: 'زبدة', d1: 'دهن مستخرج من الحليب', w2: 'مارغرين', d2: 'بديل نباتي للزبدة' },
            { cat: 'food', w1: 'تمر', d1: 'ثمرة حلوة تنمو في النخيل', w2: 'موز', d2: 'فاكهة استوائية صفراء مقوسة' },
            { cat: 'food', w1: 'تفاح', d1: 'فاكهة دائرية مقرمشة', w2: 'برتقال', d2: 'فاكهة حمضية غنية بفيتامين سي' },
            { cat: 'food', w1: 'سلطة', d1: 'طبق بارد من الخضار المقطعة', w2: 'شوربة', d2: 'حساء ساخن يقدم كبداية' },
            { cat: 'food', w1: 'حليب', d1: 'سائل أبيض غني بالكالسيوم', w2: 'كاكاو', d2: 'مسحوق يستخدم لصنع الشوكولاتة' },
            { cat: 'food', w1: 'شاي', d1: 'مشروب ساخن يحضر من أوراق النبتة', w2: 'قهوة', d2: 'مشروب منبه أسود مائل للبني' },
            { cat: 'food', w1: 'كعك', d1: 'حلوى مخبوزة دائرية', w2: 'بسكوي', d2: 'حلوى صغيرة وجافة ومقرمشة' },
            { cat: 'food', w1: 'فريت', d1: 'بطاطا مقلية مقرمشة', w2: 'بورغر', d2: 'شطيرة لحم دائرية مع إضافات' },
            { cat: 'food', w1: 'هريسة', d1: 'صلصة فلفل أحمر حارة', w2: 'مايونيز', d2: 'صلصة بيضاء كريمية من البيض والزيت' },
            { cat: 'food', w1: 'كاتشب', d1: 'صلصة حمراء حلوة من الطماطم', w2: 'موستارد', d2: 'صلصة صفراء ذات طعم لاذع' },
            { cat: 'food', w1: 'مربى', d1: 'فواكه مطبوخة مع السكر', w2: 'عسل', d2: 'سائل حلو لزج تنتجه النحل' },
            { cat: 'food', w1: 'فطير', d1: 'عجينة رقيقة مسطحة', w2: 'كرواسون', d2: 'مخبوزات فرنسية هشة على شكل هلال' },
            { cat: 'food', w1: 'بريوش', d1: 'خبز فرنسي حلو وغني بالزبدة', w2: 'بانيني', d2: 'سندويش إيطالي مضغوط ومحمص' },
            { cat: 'food', w1: 'فلافل', d1: 'كرات حمص مقلية', w2: 'حمص', d2: 'حبوب صفراء تستخدم لعمل المتبل' },

            // --- ANIMALS (الحيوانات) ---
            { cat: 'animals', w1: 'كلب', d1: 'حيوان أليف وفي حارس', w2: 'قطوس', d2: 'القط، حيوان أليف منزلي' },
            { cat: 'animals', w1: 'حمار', d1: 'حيوان صبر يستخدم للحمل', w2: 'بغل', d2: 'هجين بين الحصان والحمار' },
            { cat: 'animals', w1: 'حصان', d1: 'حيوان قوي لركوب الخيل والسباق', w2: 'جمل', d2: 'سفينة الصحراء يتحمل العطش' },
            { cat: 'animals', w1: 'خروف', d1: 'حيوان يؤخذ منه الصوف واللحم', w2: 'ماعز', d2: 'حيوان ذو قرون يؤخذ منه الحليب' },
            { cat: 'animals', w1: 'ديك', d1: 'ذكر الدجاج يصيح في الفجر', w2: 'دجاجة', d2: 'طائر يربى لإنتاج البيض' },
            { cat: 'animals', w1: 'بط', d1: 'طائر مائي بلسان عريض', w2: 'وز', d2: 'طائر مائي يشبه البط ولكنه أكبر' },
            { cat: 'animals', w1: 'نحلة', d1: 'حشرة طائرة تنتج العسل', w2: 'ذبابة', d2: 'حشرة صغيرة مزعجة ومنتشرة' },
            { cat: 'animals', w1: 'نملة', d1: 'حشرة صغيرة تعمل في جماعات', w2: 'صرصور', d2: 'حشرة زاحفة بنية اللون' },
            { cat: 'animals', w1: 'حية', d1: 'زاحف طويل يتحرك بدون أطراف', w2: 'عقرب', d2: 'حيوان سام يمتلك ذيل لاسع' },
            { cat: 'animals', w1: 'تمساح', d1: 'زاحف مائي ضخم ذو فك قوي', w2: 'سلحفاة', d2: 'زاحف بطيء ذو درع صلب' },
            { cat: 'animals', w1: 'قرش', d1: 'سمكة مفترسة خطيرة في المحيطات', w2: 'حوت', d2: 'أضخم حيوان بحري على وجه الأرض' },
            { cat: 'animals', w1: 'دلفين', d1: 'حيوان بحري ذكي وودود', w2: 'فقمة', d2: 'حيوان برمائي يعيش في المناطق الباردة' },
            { cat: 'animals', w1: 'نمر', d1: 'قط بري ضخم مخطط ومفترس', w2: 'أسد', d2: 'ملك الغابة، حيوان مفترس ذو لبدة' },
            { cat: 'animals', w1: 'فهد', d1: 'أسرع حيوان بري على الأرض', w2: 'ذيب', d2: 'الذئب الحيوان البري الذي يعوي' },
            { cat: 'animals', w1: 'قرد', d1: 'حيوان ذكي يتسلق الأشجار', w2: 'غوريلا', d2: 'أكبر أنواع القردة ضخم وثقيل' },
            { cat: 'animals', w1: 'كلب', d1: 'حيوان أليف وفي يعوي وينبح', w2: 'ثعلب', d2: 'حيوان بري معروف بالمكر والدهاء' },
            { cat: 'animals', w1: 'غزال', d1: 'حيوان بري رشيق وجميل', w2: 'أرنب', d2: 'حيوان ذو أذنين طويلتين يحب الجزر' },
            { cat: 'animals', w1: 'فأر', d1: 'قارض صغير يتسلل للمنازل', w2: 'جرذ', d2: 'قارض يشبه الفأر ولكنه أكبر حجما' },
            { cat: 'animals', w1: 'بقرة', d1: 'حيوان داجن يعطينا الحليب', w2: 'ثور', d2: 'ذكر البقرة ضخم وقوي' },
            { cat: 'animals', w1: 'حمامة', d1: 'طائر يرمز للسلام', w2: 'عصفور', d2: 'طائر صغير مغرد' },
            { cat: 'animals', w1: 'نورس', d1: 'طائر مائي يعيش قرب الشواطئ', w2: 'بومة', d2: 'طائر جارح ليلي ذو عينين كبيرتين' },
            { cat: 'animals', w1: 'ديك رومي', d1: 'طائر داجن كبير يؤكل في المناسبات', w2: 'بط', d2: 'طائر يسبح في البرك والبحيرات' },
            { cat: 'animals', w1: 'جمل', d1: 'سفينة الصحراء يخزن الماء', w2: 'ناقة', d2: 'أنثى الجمل' },
            { cat: 'animals', w1: 'حشرة', d1: 'كائن صغير ذو أرجل مفصلية', w2: 'دودة', d2: 'كائن زاحف رخوي وطويل' },
            { cat: 'animals', w1: 'دعموص', d1: 'فرخ الضفدع صغير يعيش في الماء', w2: 'بعوضة', d2: 'حشرة صغيرة تمتص الدم' },
            { cat: 'animals', w1: 'خنزير', d1: 'حيوان سمين وذو أنف أفطس', w2: 'كلب', d2: 'حيوان يعتمد عليه في الحراسة' },
            { cat: 'animals', w1: 'حصان', d1: 'حيوان سريع يستخدم في الفروسية', w2: 'حمار', d2: 'حيوان للركوب وجر العربات' },
            { cat: 'animals', w1: 'ذيب', d1: 'مفترس بري يعيش في قطعان', w2: 'نمر', d2: 'قط بري مفترس ذو فراء مخطط' },
            { cat: 'animals', w1: 'أسد', d1: 'ملك الحيوانات المفترسة', w2: 'فهد', d2: 'أسرع الحيوانات المفترسة ركضا' },
            { cat: 'animals', w1: 'قط', d1: 'حيوان منزلي أليف يموء', w2: 'نمر', d2: 'مفترس غابات ضخم مخطط' },

            // --- OBJECTS (أشياء وأدوات) ---
            { cat: 'objects', w1: 'شارجور', d1: 'الشاحن، أداة لشحن البطارية', w2: 'كابل', d2: 'سلك لتوصيل الكهرباء أو البيانات' },
            { cat: 'objects', w1: 'سماعة', d1: 'أداة توضع على الأذن لسماع الصوت', w2: 'مايكرو', d2: 'الميكروفون لتسجيل أو تكبير الصوت' },
            { cat: 'objects', w1: 'كلافيي', d1: 'لوحة المفاتيح التابعة للحاسوب', w2: 'سوري', d2: 'فأرة الحاسوب للتحكم في الشاشة' },
            { cat: 'objects', w1: 'ساعة', d1: 'أداة لمعرفة الوقت', w2: 'منبه', d2: 'ساعة تصدر صوتا لإيقاظ النائم' },
            { cat: 'objects', w1: 'كاشي', d1: 'قرص دواء للعلاج', w2: 'بلو', d2: 'اللون الأزرق' },
            { cat: 'objects', w1: 'دفتر', d1: 'كراسة لتسجيل الملاحظات والدروس', w2: 'كتاب', d2: 'مجموعة من الأوراق المطبوعة للقراءة' },
            { cat: 'objects', w1: 'قلم', d1: 'أداة تستخدم للكتابة والرسم', w2: 'ستيلو', d2: 'قلم حبر جاف' },
            { cat: 'objects', w1: 'حقيبة', d1: 'وعاء لحمل الأشياء وحفظها', w2: 'ساك', d2: 'كيس أو حقيبة للظهر أو اليد' },
            { cat: 'objects', w1: 'مفتاح', d1: 'أداة مخصصة لفتح الأقفال والأبواب', w2: 'قفل', d2: 'جهاز لإغلاق الأبواب بإحكام' },
            { cat: 'objects', w1: 'باب', d1: 'مدخل أو مخرج للغرفة أو المبنى', w2: 'شباك', d2: 'نافذة للتهوية وإدخال الضوء' },
            { cat: 'objects', w1: 'ضو', d1: 'مصدر الإنارة في المكان', w2: 'لامبة', d2: 'مصباح كهربائي يوفر الإضاءة' },
            { cat: 'objects', w1: 'بطارية', d1: 'وحدة لتخزين الطاقة الكهربائية', w2: 'شارجور', d2: 'جهاز يعيد شحن طاقة البطارية' },
            { cat: 'objects', w1: 'مروحة', d1: 'جهاز كهربائي يولد تيارا هوائيا', w2: 'كليماتيزور', d2: 'مكيف لضبط درجة حرارة الهواء' },
            { cat: 'objects', w1: 'بطانية', d1: 'غطاء من القماش يبعث على الدفء', w2: 'مخدة', d2: 'وسادة تسند الرأس عند النوم' },
            { cat: 'objects', w1: 'زرابي', d1: 'بساط منسوج يفرش على الأرضيات', w2: 'موكيت', d2: 'سجاد يغطي كامل أرضية الغرفة' },
            { cat: 'objects', w1: 'صحن', d1: 'وعاء مسطح أو مجوف لتقديم الطعام', w2: 'كاس', d2: 'وعاء أسطواني لشرب السوائل' },
            { cat: 'objects', w1: 'سكين', d1: 'أداة حادة تستخدم لتقطيع الطعام', w2: 'مغرف', d2: 'ملعقة كبيرة تستخدم لسكب الطعام' },
            { cat: 'objects', w1: 'قدر', d1: 'وعاء عميق معدني يستخدم لطبخ الطعام', w2: 'مقلة', d2: 'وعاء مسطح يستخدم للقلي في الزيت' },
            { cat: 'objects', w1: 'حوتة', d1: 'إسفنجة أو ليفة الاستحمام', w2: 'بانيو', d2: 'حوض يستعمل للاستحمام والغسيل' },
            { cat: 'objects', w1: 'صابون', d1: 'مادة تستخدم لتنظيف اليدين والجسم', w2: 'شامبو', d2: 'سائل مخصص لغسل وتنظيف الشعر' },
            { cat: 'objects', w1: 'موس', d1: 'أداة حادة لقص الشعر أو الحلاقة', w2: 'شفرة', d2: 'أداة دقيقة وحادة للحلاقة' },
            { cat: 'objects', w1: 'فرشاة', d1: 'أداة لتسريح الشعر أو تنظيف الأسنان', w2: 'مشط', d2: 'أداة مسننة لتصفيف وفك تشابك الشعر' },
            { cat: 'objects', w1: 'نظارات', d1: 'إطار بعدسات لتحسين الرؤية أو الحماية', w2: 'عدسات', d2: 'قطع دائرية صغيرة توضع على العين للرؤية' },
            { cat: 'objects', w1: 'شنطة', d1: 'حقيبة تستخدم لحمل وتخزين الأغراض', w2: 'ساكادو', d2: 'حقيبة ظهر لحمل الأشياء الثقيلة' },
            { cat: 'objects', w1: 'طابعة', d1: 'جهاز ينقل النصوص والصور إلى الورق', w2: 'سكانير', d2: 'جهاز يحول الورق إلى ملفات رقمية' },
            { cat: 'objects', w1: 'USB', d1: 'قطعة صغيرة لتخزين ونقل البيانات', w2: 'ديسك دور', d2: 'القرص الصلب لتخزين ومسح البيانات' },
            { cat: 'objects', w1: 'راوتر', d1: 'جهاز لتوزيع إشارة الإنترنت اللاسلكية', w2: 'مودام', d2: 'جهاز يحول الإشارة لشبكة إنترنت' },
            { cat: 'objects', w1: 'مانيت', d1: 'أداة للتحكم في ألعاب الفيديو', w2: 'بلايستيشن', d2: 'جهاز ألعاب فيديو منزلي شهير' },
            { cat: 'objects', w1: 'ريموت', d1: 'جهاز صغير للتحكم عن بعد بالإلكترونيات', w2: 'تلفازة', d2: 'جهاز لمشاهدة القنوات والبرامج' },
            { cat: 'objects', w1: 'مكواة', d1: 'جهاز ساخن لكي الملابس وإزالة التجاعيد', w2: 'غسالة', d2: 'جهاز كهربائي يستخدم لغسل وتنظيف الثياب' },

            // --- SPORTS (رياضة) ---
            { cat: 'sports', w1: 'فوتبول', d1: 'كرة القدم، الرياضة الأشهر عالميا', w2: 'هاندبول', d2: 'كرة اليد، تلعب بتمرير الكرة' },
            { cat: 'sports', w1: 'باسكات', d1: 'كرة السلة، رمي الكرة في السلة', w2: 'فولي', d2: 'الكرة الطائرة، ضرب الكرة فوق الشبكة' },
            { cat: 'sports', w1: 'كروس', d1: 'سباق الجري في المناطق المفتوحة', w2: 'ماراطون', d2: 'سباق جري لمسافات طويلة جدا' },
            { cat: 'sports', w1: 'كارديو', d1: 'تمارين رياضية تسرع نبض القلب', w2: 'مسكل', d2: 'تمارين كمال الأجسام وبناء العضلات' },
            { cat: 'sports', w1: 'بوش اب', d1: 'تمرين الضغط لتقوية الصدر والذراعين', w2: 'بلانك', d2: 'تمرين ثبات قوي لشد عضلات البطن' },
            { cat: 'sports', w1: 'سكوات', d1: 'تمرين القرفصاء لتقوية عضلات الساقين', w2: 'لونج', d2: 'تمرين الاندفاع لتقوية الفخذين' },
            { cat: 'sports', w1: 'دمبل', d1: 'أوزان حرة صغيرة تحمل باليد', w2: 'بار', d2: 'عمود حديدي طويل تحمل عليه الأوزان' },
            { cat: 'sports', w1: 'تريدميل', d1: 'جهاز المشي أوالجري الكهربائي', w2: 'بيسيكلات', d2: 'الدراجة الهوائية، وسيلة نقل ورياضة' },
            { cat: 'sports', w1: 'كوتش', d1: 'المدرب الرياضي الذي يوجه اللاعبين', w2: 'لاعب', d2: 'الشخص الذي يمارس رياضة معينة' },
            { cat: 'sports', w1: 'ماتش', d1: 'المباراة أو المنافسة الرياضية', w2: 'تدريب', d2: 'فترة التمرين والاستعداد للمنافسة' },
            { cat: 'sports', w1: 'هدف', d1: 'إدخال الكرة في المرمى لتسجيل نقطة', w2: 'بنالتي', d2: 'ضربة الجزاء بعد ارتكاب خطأ معين' },
            { cat: 'sports', w1: 'كارتون', d1: 'بطاقة ملونة ينذر بها الحكم', w2: 'فول', d2: 'خطأ يرتكبه اللاعب أثناء المباراة' },
            { cat: 'sports', w1: 'شوط', d1: 'جزء زمني من المباراة الرياضية', w2: 'وقت', d2: 'الزمن المحدد للمباراة أو الشوط' },
            { cat: 'sports', w1: 'ملعب', d1: 'مساحة مخصصة للعب وممارسة الرياضة', w2: 'قاعة', d2: 'مكان مغلق لممارسة الرياضات المتنوعة' },
            { cat: 'sports', w1: 'جيم', d1: 'صالة كمال الأجسام والألعاب الرياضية', w2: 'كروسفيت', d2: 'رياضة شاملة للتمارين عالية الكثافة' },
            { cat: 'sports', w1: 'سباحة', d1: 'الحركة والتحرك عبر الماء', w2: 'غوص', d2: 'السباحة تحت سطح الماء بعمق' },
            { cat: 'sports', w1: 'ركوب', d1: 'امتطاء الخيل أو الدراجة', w2: 'قفز', d2: 'الانطلاق في الهواء بالاعتماد على القدمين' },
            { cat: 'sports', w1: 'ميدالية', d1: 'قلادة معدنية تعطى للفائز في المسابقة', w2: 'كأس', d2: 'جائزة بشكل كأس تمنح للفريق الفائز' },
            { cat: 'sports', w1: 'بطولة', d1: 'منافسة كبرى لتحديد الأفضل بين الفرق', w2: 'دوري', d2: 'منافسة رياضية مستمرة على مدار موسم' },
            { cat: 'sports', w1: 'منتخب', d1: 'فريق رياضي يمثل وطنه كاملاً', w2: 'نادي', d2: 'فريق رياضي محلي يمثل مدينة أو جهة' },
            { cat: 'sports', w1: 'حكم', d1: 'الشخص الذي يدير ويضبط المباراة', w2: 'مساعد', d2: 'من يساعد الحكم في اتخاذ القرارات' },
            { cat: 'sports', w1: 'تسلل', d1: 'مخالفة تجاوز اللاعب لخط الدفاع المنافس', w2: 'ضربة', d2: 'ركلة الكرة أو توجيهها بقوة' },
            { cat: 'sports', w1: 'تمرير', d1: 'مناولة الكرة إلى لاعب آخر في الفريق', w2: 'تسديد', d2: 'توجيه ضربة قوية للكرة نحو المرمى' },
            { cat: 'sports', w1: 'هجوم', d1: 'محاولة التقدم وتسجيل الأهداف', w2: 'دفاع', d2: 'التصدي للاعبي الخصم ومنعهم من التسجيل' },
            { cat: 'sports', w1: 'لياقة', d1: 'القدرة البدنية والصحية الجيدة', w2: 'سرعة', d2: 'القدرة على الركض والتحرك في وقت قصير' },
            { cat: 'sports', w1: 'توازن', d1: 'القدرة على الثبات في موقف معين', w2: 'قوة', d2: 'قوة العضلات والقدرة على التحمل' },
            { cat: 'sports', w1: 'مضمار', d1: 'مسار مخصص لسباقات الجري أو الخيل', w2: 'حلبة', d2: 'مساحة مخصصة لرياضات النزال كالملاكمة' },
            { cat: 'sports', w1: 'سباق', d1: 'منافسة على الركض أو الوصول أولاً', w2: 'منافسة', d2: 'صراع رياضي بين أطراف للفوز المنشود' },
            { cat: 'sports', w1: 'مدرب', d1: 'الشخص الذي يخطط ويوجه الفريق', w2: 'لاعب', d2: 'الشخص المشارك في ممارسة الرياضة' },
            { cat: 'sports', w1: 'احتياط', d1: 'اللاعبون الجالسون بانتظار دورهم للعب', w2: 'أساسي', d2: 'اللاعب المعتمد عليه في التشكيلة الأساسية' },

            // --- FUNNY/SLANG (تمنيك/هدرة) ---
            { cat: 'funny', w1: 'واش', d1: 'ماذا؟ أداة استفهام وتعبير للتعجب', w2: 'علاه', d2: 'لماذا؟ للاستفسار عن السبب' },
            { cat: 'funny', w1: 'بزاف', d1: 'كثيراً جداً', w2: 'شوية', d2: 'قليلاً، مقدار صغير' },
            { cat: 'funny', w1: 'صح', d1: 'صحيح، تماما، أو حقا', w2: 'كذب', d2: 'غير الحقيقة، بهتان' },
            { cat: 'funny', w1: 'حومة', d1: 'الحي أو المنطقة السكنية', w2: 'بلاد', d2: 'الوطن أو الدولة بأكملها' },
            { cat: 'funny', w1: 'خويا', d1: 'يا أخي، للنداء والتودد', w2: 'صاحبي', d2: 'يا صديقي، رفيق الدرب' },
            { cat: 'funny', w1: 'برك', d1: 'يكفي، أو توقف عند هذا الحد', w2: 'صافي', d2: 'انتهى الأمر، هكذا إذن' },
            { cat: 'funny', w1: 'دير', d1: 'افعل أو قم بـ...', w2: 'حبس', d2: 'توقف الآن، امتنع' },
            { cat: 'funny', w1: 'جيب', d1: 'أحضر أو أحضر لي', w2: 'دي', d2: 'خذ معك، ارتحل بـ...' },
            { cat: 'funny', w1: 'روح', d1: 'اذهب وغادر المكان', w2: 'اجي', d2: 'تعالى إلينا واقترب' },
            { cat: 'funny', w1: 'نوض', d1: 'انهض وقم من مكانك', w2: 'اقعد', d2: 'اجلس واسترح في مكانك' },
            { cat: 'funny', w1: 'باهي', d1: 'جيد وحسن المنظر أو الفعل', w2: 'شابة', d2: 'جميلة ولائقة' },
            { cat: 'funny', w1: 'غلط', d1: 'خطأ وغير مبني على صواب', w2: 'صح', d2: 'موافق للصواب والمنطق' },
            { cat: 'funny', w1: 'ساهل', d1: 'يسير ولا يحتاج جهدا', w2: 'صعيب', d2: 'شاق ومعقد وصعب المراس' },
            { cat: 'funny', w1: 'سريع', d1: 'ذو سرعة ولا يتمهل', w2: 'بطئ', d2: 'يتأخر ويأخذ وقتا أكثر من اللازم' },
            { cat: 'funny', w1: 'مليح', d1: 'طيب وحسن وبحالة جيدة', w2: 'خايب', d2: 'سيء ومزعج وقبيح' },
            { cat: 'funny', w1: 'نحبك', d1: 'أودك وأميل إليك', w2: 'نكرهك', d2: 'أبغضك ولا أطيقك' },
            { cat: 'funny', w1: 'ضحك', d1: 'أبدى السرور وابتسم بصوت', w2: 'بكى', d2: 'ذرف الدموع حزنا أو ألما' },
            { cat: 'funny', w1: 'طويل', d1: 'شامخ وممتد الطول', w2: 'قصير', d2: 'صغير القامة غير ممتد' },
            { cat: 'funny', w1: 'سمين', d1: 'ممتلئ الجسم، شحم كثير', w2: 'ضعيف', d2: 'نحيف وهزيل الجسم' },
            { cat: 'funny', w1: 'حر', d1: 'طقس ساخن جدا', w2: 'برد', d2: 'درجة حرارة منخفضة تجعلك ترتجف' },
            { cat: 'funny', w1: 'نهار', d1: 'وقت ظهور الشمس، مضيء', w2: 'ليل', d2: 'غياب الشمس، ووقت السبات المظلم' },
            { cat: 'funny', w1: 'فوق', d1: 'في الجزء العلوي', w2: 'تحت', d2: 'في الجزء السفلي والأسفل' },
            { cat: 'funny', w1: 'قدام', d1: 'في الأمام والمقدمة', w2: 'لور', d2: 'في الوراء والخلف' },
            { cat: 'funny', w1: 'يمين', d1: 'جهة اليد اليمنى', w2: 'يسار', d2: 'جهة اليد اليسرى' },
            { cat: 'funny', w1: 'داخل', d1: 'في جوف الشيء وباطنه', w2: 'برا', d2: 'في الخارج وظاهر الشيء' },
            { cat: 'funny', w1: 'بلاصة', d1: 'الموضع أو الحيز الفارغ', w2: 'مكان', d2: 'حيز محدد للتمركز' },
            { cat: 'funny', w1: 'عادي', d1: 'مألوف ولا غرابة فيه', w2: 'غريب', d2: 'غير مألوف ومثير للتعجب' },
            { cat: 'funny', w1: 'مفهوم', d1: 'واضح جلي للمستمع', w2: 'معقد', d2: 'شائك ويصعب تبسيطه' },
            { cat: 'funny', w1: 'باهي', d1: 'الأمر جيد ومستحسن', w2: 'كارثة', d2: 'مصيبة وأمر وخيم العواقب' },
            { cat: 'funny', w1: 'هايل', d1: 'رائع جدا وفوق الوصف', w2: 'زفت', d2: 'سيء للغاية ولا يطاق' },

            // --- BODY (الجسم) ---
            { cat: 'body', w1: 'راس', d1: 'الجزء العلوي من الجسم يحوي المخ', w2: 'وجه', d2: 'الجزء الأمامي من الرأس فيه الملامح' },
            { cat: 'body', w1: 'عين', d1: 'عضو الإبصار والنظر', w2: 'ودن', d2: 'عضو السمع والتقاط الأصوات' },
            { cat: 'body', w1: 'نيف', d1: 'الأنف، عضو الشم والتنفس', w2: 'فم', d2: 'عضو التذوق والأكل والكلام' },
            { cat: 'body', w1: 'سنان', d1: 'تستخدم لتقطيع وطحن الطعام', w2: 'لسان', d2: 'عضو التذوق والبلع في الفم' },
            { cat: 'body', w1: 'رقبة', d1: 'العنق، يربط الرأس بالجذع', w2: 'كتف', d2: 'الجزء الواصل بين العنق والجذع والذراع' },
            { cat: 'body', w1: 'ذراع', d1: 'الطرف العلوي من الكتف لليد', w2: 'يد', d2: 'نهاية الذراع، تستعمل للمسك والقبض' },
            { cat: 'body', w1: 'صبع', d1: 'أحد أطراف اليد أو القدم', w2: 'ظفر', d2: 'الجزء الصلب في نهاية الإصبع' },
            { cat: 'body', w1: 'صدر', d1: 'الجزء الأمامي من الجذع', w2: 'ظهر', d2: 'الجزء الخلفي من الجذع' },
            { cat: 'body', w1: 'كرش', d1: 'منطقة البطن والمعدة', w2: 'ظهر', d2: 'الجهة الخلفية للجسم' },
            { cat: 'body', w1: 'رجل', d1: 'الطرف السفلي الممتد من الفخذ', w2: 'ركبة', d2: 'المفصل القوي في منتصف الساق' },
            { cat: 'body', w1: 'فخذ', d1: 'الجزء العلوي من الرجل', w2: 'ساق', d2: 'الجزء بين الركبة والقدم' },
            { cat: 'body', w1: 'كعب', d1: 'الجزء الخلفي السفلي من القدم', w2: 'قدم', d2: 'أسفل الساق، للوقوف والمشي' },
            { cat: 'body', w1: 'عضلة', d1: 'نسيج لحمي يحرك الهيكل العظمي', w2: 'عظم', d2: 'الأجزاء الصلبة التي تدعم الجسم' },
            { cat: 'body', w1: 'دم', d1: 'السائل الأحمر الذي يدور في العروق', w2: 'جلد', d2: 'الطبقة الخارجية التي تغطي الجسم كله' },
            { cat: 'body', w1: 'شعر', d1: 'ينمو على فروة الرأس وأماكن أخرى', w2: 'لحية', d2: 'الشعر النابت على الذقن والخدين' },
            { cat: 'body', w1: 'مخ', d1: 'عضو التفكير والتحكم في داخل الجمجمة', w2: 'قلب', d2: 'العضلة التي تضخ الدم لكامل الجسم' },
            { cat: 'body', w1: 'عينين', d1: 'عضوا الرؤية والبصر', w2: 'حواجب', d2: 'خط الشعر الموجود فوق العيون' },
            { cat: 'body', w1: 'رموش', d1: 'الأشعار الصغيرة في جفون العيون', w2: 'جبهة', d2: 'الجزء العلوي والمسطح من الوجه' },
            { cat: 'body', w1: 'خشم', d1: 'الأنف في لهجات معينة', w2: 'فم', d2: 'فتحة التغذية والنطق في الوجه' },
            { cat: 'body', w1: 'دقن', d1: 'الجزء الأسفل من الوجه تحت الفم', w2: 'لحية', d2: 'شعر الوجه عند الرجال' },
            { cat: 'body', w1: 'ضلوع', d1: 'عظام قفص الصدر التي تحمي القلب', w2: 'عمود فقري', d2: 'سلسلة العظام في الظهر لدعم القامة' },
            { cat: 'body', w1: 'كتاف', d1: 'مفصل أعلى الذراعين', w2: 'صدر', d2: 'المنطقة الحاوية للقلب والرئتين' },
            { cat: 'body', w1: 'كف', d1: 'باطن اليد', w2: 'يد', d2: 'الجزء الذي نستخدمه للملامسة والمسك' },
            { cat: 'body', w1: 'أصابع', d1: 'أطراف متفرعة للقبض في اليد', w2: 'كف', d2: 'الجهة الداخلية المسطحة لليد' },
            { cat: 'body', w1: 'ركبة', d1: 'مفصل يفصل بين الفخذ والساق', w2: 'ساق', d2: 'مابين الركبة ومفصل القدم' },
            { cat: 'body', w1: 'كعب', d1: 'العظمة البارزة في آخر القدم', w2: 'رجل', d2: 'الطرف بأكمله المخصص للوقوف والمشي' },
            { cat: 'body', w1: 'جلد', d1: 'الغلاف الخارجي والحساس للجسم', w2: 'شعر', d2: 'خيوط بروتينية تنمو من الجلد' },
            { cat: 'body', w1: 'دماغ', d1: 'مركز الجهاز العصبي والتحكم', w2: 'مخ', d2: 'القسم الأكبر من الدماغ للتفكير' },
            { cat: 'body', w1: 'قلب', d1: 'عضو حيوي لاستمرار تدفق الدم', w2: 'رئة', d2: 'عضو التنفس ومبادلة الأكسجين' },
            { cat: 'body', w1: 'معدة', d1: 'كيس هضمي في البطن لمعالجة الطعام', w2: 'كبد', d2: 'عضو كبير يخلص الجسم من السموم' },

            // --- PLACES (بلايص) ---
            { cat: 'places', w1: 'وهران', d1: 'مدينة جزائرية ساحلية كبرى، الباهية', w2: 'دزاير', d2: 'العاصمة الجزائرية، مدينة بيضاء' },
            { cat: 'places', w1: 'سطيف', d1: 'مدينة التجارة وعاصمة الهضاب العليا', w2: 'تيزي', d2: 'تيزي وزو، عاصمة الثقافة الأمازيغية' },
            { cat: 'places', w1: 'بجاية', d1: 'مدينة ساحلية وجبلية ذات طبيعة خلابة', w2: 'جيجل', d2: 'مدينة ساحلية يكسوها الكورنيش والبحر' },
            { cat: 'places', w1: 'تلمسان', d1: 'لؤلؤة الغرب، عاصمة التاريخ والفن', w2: 'معسكر', d2: 'مدينة الأمير عبد القادر، عاصمة تاريخية' },
            { cat: 'places', w1: 'الجزائر', d1: 'الجمهورية الجزائرية، أكبر بلد عربي', w2: 'تونس', d2: 'البلد المجاور للجزائر من الشرق' },
            { cat: 'places', w1: 'المغرب', d1: 'المملكة المجاورة من الجهة الغربية', w2: 'فرنسا', d2: 'دولة أوروبية تطل ضفتها على البحر المتوسط' },
            { cat: 'places', w1: 'إسبانيا', d1: 'دولة أوروبية عاصمتها مدريد', w2: 'إيطاليا', d2: 'دولة أوروبية شهيرة بالباستا وعاصمتها روما' },
            { cat: 'places', w1: 'حومة', d1: 'الحي السكني أو المنطقة الشعبية', w2: 'حي', d2: 'تجمع للمنازل والمباني السكنية' },
            { cat: 'places', w1: 'شارع', d1: 'الطريق الواسع لمرور المركبات والناس', w2: 'زنقة', d2: 'شارع ضيق أو ممشى مغلق بين المنازل' },
            { cat: 'places', w1: 'دار', d1: 'المنزل أو المكان الذي تسكن فيه العائلة', w2: 'فيلا', d2: 'منزل كبير ومنفصل ذو طوابق وحديقة' },
            { cat: 'places', w1: 'عمارة', d1: 'مبنى سكني شاهق يضم شققا ومصاعد', w2: 'سطح', d2: 'أعلى جزء مكشوف في المبنى أو المنزل' },
            { cat: 'places', w1: 'غرفة', d1: 'حجرة مغلقة ومنفصلة في المنزل', w2: 'صالون', d2: 'غرفة استقبال الضيوف والجلوس' },
            { cat: 'places', w1: 'مطبخ', d1: 'مكان مجهز لتحضير وطهى الطعام', w2: 'حمام', d2: 'غرفة مخصصة للاستحمام والغسيل' },
            { cat: 'places', w1: 'مدرسة', d1: 'مؤسسة تعليمية لتدريس الأطفال والشباب', w2: 'جامعة', d2: 'مؤسسة للتعليم العالي والدراسات الأكاديمية' },
            { cat: 'places', w1: 'جامع', d1: 'المسجد الكبير لإقامة الصلوات', w2: 'كنيسة', d2: 'مكان عبادة مخصص للمسيحيين' },
            { cat: 'places', w1: 'قهوة', d1: 'المقهى الشعبي لتقديم القهوة والشاي', w2: 'مطعم', d2: 'مكان يقدم وجبات الطعام للزبائن' },
            { cat: 'places', w1: 'محل', d1: 'دكان صغير لبيع البضائع المحددة', w2: 'سوق', d2: 'مكان مفتوح يجمع العديد من المحلات والبسطات' },
            { cat: 'places', w1: 'مول', d1: 'مركز تسوق تجاري كبير ومغلق', w2: 'مارشي', d2: 'السوق الشعبي اليومي للخضار والمعروضات' },
            { cat: 'places', w1: 'حديقة', d1: 'مساحة خضراء مجهزة بالورود وألعاب الأطفال', w2: 'غابة', d2: 'مساحة شاسعة كثيفة الأشجار والحيوانات' },
            { cat: 'places', w1: 'بحر', d1: 'مساحة مياه طبيعية مالحة وكبيرة', w2: 'جبل', d2: 'تضاريس عالية ومرتفعة عن سطح الأرض' },
            { cat: 'places', w1: 'صحراء', d1: 'مناطق رملية حارة وقاحلة مترامية الأطراف', w2: 'واحة', d2: 'منطقة خصبة ذات أشجار وسط رمال الصحراء' },
            { cat: 'places', w1: 'مطار', d1: 'محطة مخصصة لإقلاع وهبوط الطائرات والسفر', w2: 'ميناء', d2: 'مساحة تابعة للبحر مخصصة لرسو السفن' },
            { cat: 'places', w1: 'محطة', d1: 'مكان لركوب المسافرين الحافلات أوالقطار', w2: 'موقف', d2: 'مكان مخصص لركن وإيقاف السيارات' },
            { cat: 'places', w1: 'فندق', d1: 'مبنى ضيافة ومبيت للمسافرين والزوار', w2: 'نزل', d2: 'دار ضيافة شعبية واقتصادية للمبيت' },
            { cat: 'places', w1: 'مستشفى', d1: 'مركز طبي متكامل لمعالجة حالات المرضى', w2: 'عيادة', d2: 'مبنى أو غرفة مخصصة للمعاينة الطبية والفحص' },
            { cat: 'places', w1: 'صيدلية', d1: 'محل لبيع الأدوية والمستلزمات الطبية', w2: 'مخبر', d2: 'معمل ومكان إجراء تحاليل طبية وعلمية' },
            { cat: 'places', w1: 'ملعب', d1: 'ميدان مسور تقام على أرضه ممارسات الرياضية', w2: 'قاعة', d2: 'بناء داخلي واسع لإقامة التظاهرات والمناسبات' },
            { cat: 'places', w1: 'مسرح', d1: 'خشبة ومكان لأداء التمثيليات والمسرحيات', w2: 'سينما', d2: 'صالة مغلقة لعرض ومشاهدة الأفلام والأشرطة' },
            { cat: 'places', w1: 'بنك', d1: 'مصرف ومؤسسة مالية تحفظ نقود ومدخرات المواطن', w2: 'بريد', d2: 'مؤسسة إرسال طرود رسائل وتحويل أموال' },
            { cat: 'places', w1: 'إدارة', d1: 'هيئة عامة مختصة بتنظيم وتسوية معاملات', w2: 'بلدية', d2: 'وحدة إدارية تعنى بشؤون المدينة والمواطنين' },

            // --- JOBS (مهن وخدمات) ---
            { cat: 'jobs', w1: 'طبيب', d1: 'يشخص الأمراض ويعالج المرضى', w2: 'جراح', d2: 'طبيب مختص في إجراء العمليات الجراحية الدقيقة' },
            { cat: 'jobs', w1: 'ممرض', d1: 'يساعد الطبيب ويسهر على راحة المريض وعلاجه', w2: 'صيدلي', d2: 'مختص يحضر ويصرف الأدوية للمرضى' },
            { cat: 'jobs', w1: 'شرطي', d1: 'رجل الأمن يسهر على حفظ النظام وتطبيق القانون', w2: 'دركي', d2: 'عنصر في قوات الدرك الوطني لحفظ أمن المناطق' },
            { cat: 'jobs', w1: 'عسكري', d1: 'فرد ينتمي للقوات المسلحة للدفاع عن الوطن', w2: 'حارس', d2: 'شخص مكلف بمراقبة وحماية منشأة أو مكان' },
            { cat: 'jobs', w1: 'أستاذ', d1: 'معلم ومربي يعمل في التدريس ونقل المعرفة', w2: 'معلم', d2: 'مربي يعلم الأطفال في المراحل الدراسية والابتدائية' },
            { cat: 'jobs', w1: 'مدير', d1: 'المسؤول الأول و الموجه لإدارة عمل المؤسسة', w2: 'مراقب', d2: 'شخص مكلف بمتابعة ومراجعة سير عمل وسلوكيات' },
            { cat: 'jobs', w1: 'سائق', d1: 'الشخص الذي يقود ويمتهن قيادة المركبات', w2: 'طاكسيور', d2: 'سائق سيارة أجرة لغرض نقل الأفراد' },
            { cat: 'jobs', w1: 'ميكانيكي', d1: 'خبير في إصلاح أعطال ومحركات السيارات والآليات', w2: 'كهربائي', d2: 'تغني بتركيب أو استكشاف وإصلاح أعطال شبكات الكهرباء' },
            { cat: 'jobs', w1: 'بناء', d1: 'حرفي يتولى إقامة وإنشاء الجدران والمباني', w2: 'دهان', d2: 'حرفي يطلي الجدران والأبنية ليضفي لمسات جمالية' },
            { cat: 'jobs', w1: 'نجار', d1: 'حرفي ماهر يعمل في قص ونحت وتجميع الأخشاب', w2: 'حداد', d2: 'يصنع ويطوع المعادن لتصنيع الأبواب والشبابيك' },
            { cat: 'jobs', w1: 'طباخ', d1: 'المسؤول عن تحضير وإعداد الوجبات والأطباق', w2: 'خباز', d2: 'يتقن مهنة العجن وخبز أنواع الخبز والحلويات' },
            { cat: 'jobs', w1: 'نادل', d1: 'جرسون ومقدم مشروبات وطلبات طعام في المطاعم', w2: 'قهواجي', d2: 'محضر ومقدم القهوة والشاي للزبائن داخل المقاهي' },
            { cat: 'jobs', w1: 'تاجر', d1: 'رجل الأعمال والمكلف بشراء وبيع السلع للتربح', w2: 'بائع', d2: 'يتعامل مباشرة من وراء المكتب و يعرض السلع للعملاء' },
            { cat: 'jobs', w1: 'محاسب', d1: 'ينظم الحسابات المالية ويتتبع الأرصدة والمصروفات', w2: 'موظف', d2: 'شخص يعمل لقاء أجر ويؤدي المهام الإدارية بالمؤسسة' },
            { cat: 'jobs', w1: 'مهندس', d1: 'مختص يضع التصاميم والخرائط لإنجاز ومتابعة المشاريع', w2: 'تقني', d2: 'صاحب مهارات تطبيقية يتعامل مع الآلات والمعدات المعقدة' },
            { cat: 'jobs', w1: 'مطور', d1: 'يطور البرامج و الأنظمة ويبتكر حلول للتطبيقات', w2: 'مبرمج', d2: 'يكتب سطور الأكواد بلغات البرمجة ويصمم البرمجيات' },
            { cat: 'jobs', w1: 'مصمم', d1: 'فنان يبدع في تنظيم الأشكال وإضفاء لمسات الإبداع', w2: 'مصور', d2: 'بستعمل الكاميرات ليلتقط مشاهد وصور احترافية' },
            { cat: 'jobs', w1: 'صحفي', d1: 'يتقصى الحقائق ويكتب الأخبار لوسائل الإعلام المختلفة', w2: 'مذيع', d2: 'يقدم ويدير الحوارات والبرامج في الإذاعة أو الشاشة' },
            { cat: 'jobs', w1: 'فلاح', d1: 'المزارع العامل في الحقول للزراعة ورعاية الأراضي', w2: 'مربي', d2: 'يعتني بتربية المواشي والدواجن لأغراض الإنتاج' },
            { cat: 'jobs', w1: 'صياد', d1: 'يمتهن اصطياد الأسماك أو مطاردة الحيوانات', w2: 'بحار', d2: 'يعمل على متن المراكب والسفن في عروض البحر' },
            { cat: 'jobs', w1: 'عامل', d1: 'من يبذل المجهود المادي العضلي نظير أجرة في المصانع', w2: 'حمال', d2: 'يساعد في نقل وحمل الأمتعة والصناديق والبضائع الثقيلة' },
            { cat: 'jobs', w1: 'حلاق', d1: 'يتقن مهنة قص وتهذيب شعر الرأس واللحية', w2: 'تجميل', d2: 'يهتم بتزيين المرأة وبوضع مستحضرات وماكياج التجميل' },
            { cat: 'jobs', w1: 'خياط', d1: 'يفصل الأقمشة ويحيك الملبوسات والفساتين والثياب', w2: 'مصمم', d2: 'مبتكر أزياء وموديلات يرسم خطوط وتصاميم حديثة' },
            { cat: 'jobs', w1: 'مغني', d1: 'يؤدي الأغاني بصوته ويطرب الجمهور والمستمعين', w2: 'موسيقي', d2: 'فنان محترف في العزف واللعب على الآلات الموسيقية' },
            { cat: 'jobs', w1: 'ممثل', d1: 'يتقمص الأدوار وأداء الشخصيات في السينما أوالمسرح', w2: 'كوميدي', d2: 'شخص فكاهي يصنع الضحك ويرسم بسمة الجمهور' },
            { cat: 'jobs', w1: 'يوتوبر', d1: 'يصنع محتوى فيديو ترفيهي أو وثائقي ليضعه بمنصة يوتيوب', w2: 'تيكتوكر', d2: 'مؤثر ينشئ وينشر الفيديوهات القصيرة في منصة التيكتوك' },
            { cat: 'jobs', w1: 'ستريمر', d1: 'ببث ويلعب ألعاب الفيديو ويتفاعل مع المتابعين مباشرة', w2: 'لاعب', d2: 'يمارس إحدى أنواع الرياضة ضمن صفوف فرق محترفة' },
            { cat: 'jobs', w1: 'حارس', d1: 'مهمته حراسة الأشخاص أوالمباني وأصول الشركات لحمايتها', w2: 'منظف', d2: 'يعتني بنظافة المكان من أوساخ وقمامة وتوفير محيط صحي' },
            { cat: 'jobs', w1: 'ساعي', d1: 'ساعي البريد يوصل الرسائل والبطاقات والطرد للعنوان', w2: 'موزع', d2: 'موزع طلبيات وبضائع يقوم بتسليمها إلى مكان المشتري' },
            { cat: 'jobs', w1: 'موظف', d1: 'شخص مسجل بدوام في مؤسسة لإنجاز خدمات إدارية', w2: 'مدير', d2: 'شخص قيادي يتولى إدارة العاملين وسير التنظيم بالمؤسسة' },
        ];

        // --- State ---
        let gameState = {
            numPlayers: 4,
            numImposters: 1,
            discussionTime: 60,
            mode: 'classic',
            category: 'all',
            includeSpy: false,
            includeBlind: false,
            players: [], // { id, role, word, subtext }
            currentPlayerIdx: 0,
            originalWord: '',
            fakeWord: '',
            revealTimer: null,
            discussionTimerInterval: null,
            discussionTimeRemaining: 0,
            votedOutId: null,
            spyChoice: null,
            winnerTitle: '',
            winnerSubtitle: ''
        };

        const categoryNames = {
            'all': 'الكل',
            'food': 'طعام',
            'animals': 'حيوانات',
            'objects': 'أدوات',
            'sports': 'رياضة',
            'funny': 'مضحك / تمنيك',
            'body': 'جسم',
            'places': 'مدن / دول',
            'jobs': 'مهن'
        };

        // --- Audio Context for Sfx ---
        const playSfx = (type) => {
            try {
                const AudioContextClass = window.AudioContext || window.webkitAudioContext;
                if (!AudioContextClass) return; // Silent fallback if not supported

                const ctx = new AudioContextClass();
                const osc = ctx.createOscillator();
                const gain = ctx.createGain();

                osc.connect(gain);
                gain.connect(ctx.destination);

                if (type === 'reveal') {
                    osc.type = 'triangle';
                    osc.frequency.setValueAtTime(440, ctx.currentTime);
                    osc.frequency.exponentialRampToValueAtTime(880, ctx.currentTime + 0.1);
                    gain.gain.setValueAtTime(0.1, ctx.currentTime);
                    gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.2);
                    osc.start();
                    osc.stop(ctx.currentTime + 0.2);
                } else if (type === 'click') {
                    osc.type = 'sine';
                    osc.frequency.setValueAtTime(800, ctx.currentTime);
                    gain.gain.setValueAtTime(0.05, ctx.currentTime);
                    gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.1);
                    osc.start();
                    osc.stop(ctx.currentTime + 0.1);
                } else if (type === 'tick') {
                    osc.type = 'sine';
                    osc.frequency.setValueAtTime(1200, ctx.currentTime);
                    gain.gain.setValueAtTime(0.02, ctx.currentTime);
                    gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.05);
                    osc.start();
                    osc.stop(ctx.currentTime + 0.05);
                } else if (type === 'timeout') {
                    osc.type = 'sawtooth';
                    osc.frequency.setValueAtTime(300, ctx.currentTime);
                    osc.frequency.exponentialRampToValueAtTime(150, ctx.currentTime + 0.5);
                    gain.gain.setValueAtTime(0.1, ctx.currentTime);
                    gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.8);
                    osc.start();
                    osc.stop(ctx.currentTime + 0.8);
                } else if (type === 'home') {
                    osc.type = 'sine';
                    osc.frequency.setValueAtTime(880, ctx.currentTime);
                    osc.frequency.setValueAtTime(660, ctx.currentTime + 0.1);
                    gain.gain.setValueAtTime(0.1, ctx.currentTime);
                    gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.2);
                    osc.start();
                    osc.stop(ctx.currentTime + 0.2);
                } else if (type === 'win') {
                    osc.type = 'square';
                    osc.frequency.setValueAtTime(400, ctx.currentTime);
                    osc.frequency.setValueAtTime(600, ctx.currentTime + 0.1);
                    osc.frequency.setValueAtTime(800, ctx.currentTime + 0.2);
                    gain.gain.setValueAtTime(0.1, ctx.currentTime);
                    gain.gain.linearRampToValueAtTime(0, ctx.currentTime + 0.5);
                    osc.start();
                    osc.stop(ctx.currentTime + 0.5);
                }
            } catch (error) {
                console.warn("Audio play failed, likely due to mobile browser autoplay policies:", error);
            }
        };

        const vibrate = (ms = 50) => {
            if (navigator.vibrate) navigator.vibrate(ms);
        };

        // --- UI Helpers ---
        const showScreen = (id) => {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById(id).classList.add('active');
        };

        // --- Game Logic ---
        const initGame = () => {
            let pool = wordDatabase;
            if (gameState.category !== 'all') {
                pool = wordDatabase.filter(w => w.cat === gameState.category);
            }
            const pair = pool[Math.floor(Math.random() * pool.length)];
            gameState.originalWord = pair.w1;
            gameState.fakeWord = pair.w2;

            // Generate Roles Array
            let roles = [];
            gameState.includeSpy = document.getElementById('spy-toggle').checked;
            gameState.includeBlind = document.getElementById('blind-toggle').checked;

            if (gameState.includeSpy) roles.push('spy');
            if (gameState.includeBlind) roles.push('blind');
            for (let i = 0; i < gameState.numImposters; i++) roles.push('imposter');

            while (roles.length < gameState.numPlayers) {
                roles.push('normal');
            }
            if (roles.length > gameState.numPlayers) {
                roles = roles.slice(0, gameState.numPlayers);
            }
            roles.sort(() => Math.random() - 0.5);

            gameState.players = roles.map((role, i) => {
                let word = gameState.originalWord;
                let subtext = '';

                if (role === 'imposter') {
                    word = (gameState.mode === 'classic') ? 'المحتال' : gameState.fakeWord;
                } else if (role === 'spy') {
                    word = 'أنت الجاسوس';
                } else if (role === 'blind') {
                    word = 'أنت الأعمى';
                    subtext = 'لا ترى أية كلمة، لكنك لست المحتال.';
                }

                return {
                    id: i + 1,
                    role: role,
                    word: word,
                    subtext: subtext
                };
            });

            // Inform spy of the imposter
            const imposterIds = gameState.players.filter(p => p.role === 'imposter').map(p => p.id);
            gameState.players.forEach(p => {
                if (p.role === 'spy') {
                    p.subtext = `المحتال هو اللاعب: ${imposterIds.join(' و ')}. لا تكشف نفسك حتى يتم كشفه!`;
                }
            });

            gameState.currentPlayerIdx = 0;
            gameState.votedOutId = null;
            gameState.spyChoice = null;

            // Show home button
            document.getElementById('home-btn').classList.remove('hidden');

            showScreen('screen-pass');
            updatePassScreen();
        };

        const updatePassScreen = () => {
            const display = document.getElementById('current-player-display');
            display.innerText = gameState.players[gameState.currentPlayerIdx].id;

            // Trigger reflow to restart CSS animations
            const screenPass = document.getElementById('screen-pass');
            const animatedElements = screenPass.querySelectorAll('.fade-in-up');
            animatedElements.forEach(el => {
                el.classList.remove('fade-in-up');
                void el.offsetWidth; // Trigger reflow
                el.classList.add('fade-in-up');
            });
        };

        const nextPlayer = () => {
            gameState.currentPlayerIdx++;
            if (gameState.currentPlayerIdx < gameState.players.length) {
                showScreen('screen-pass');
                updatePassScreen();
            } else {
                showScreen('screen-game');
                document.getElementById('game-word-hint').innerText = (gameState.mode === 'classic') ? '؟؟؟؟' : 'تشابه الكلمات';

                // Reset timer UI for discussion screen
                clearInterval(gameState.discussionTimerInterval);
                gameState.discussionTimeRemaining = gameState.discussionTime;
                updateTimerDisplay();
                document.getElementById('start-timer-btn').disabled = false;
                document.getElementById('stop-timer-btn').disabled = true;
                const timerDisplay = document.getElementById('discussion-timer');
                timerDisplay.classList.remove('running', 'warning');
            }
        };

        const buildVotingList = () => {
            const list = document.getElementById('voting-list');
            list.innerHTML = '';
            gameState.players.forEach(p => {
                const item = document.createElement('div');
                item.className = 'voting-item';
                item.innerHTML = `
                    <div class="p-num">اللاعب</div>
                    <div class="p-name">${p.id}</div>
                `;
                item.onclick = () => {
                    document.querySelectorAll('.voting-item').forEach(el => el.classList.remove('selected'));
                    item.classList.add('selected');
                    gameState.votedOutId = p.id;
                    document.getElementById('confirm-vote-btn').classList.remove('hidden');
                    playSfx('click');
                };
                list.appendChild(item);
            });
        };

        const showVotingReveal = () => {
            const votedPlayer = gameState.players.find(p => p.id === gameState.votedOutId);
            const titleEl = document.getElementById('voting-result-title');
            const textEl = document.getElementById('voting-result-text');

            showScreen('screen-voting-reveal');

            if (votedPlayer.role === 'imposter') {
                titleEl.innerText = "تم طرد المحتال!";
                titleEl.style.color = "var(--primary-light)";
                textEl.innerText = "نجح المواطنون في اكتشاف المحتال.";
                vibrate([100, 50, 100]);
            } else {
                titleEl.innerText = "طرد خاطئ!";
                titleEl.style.color = "var(--secondary)";
                textEl.innerText = "اللاعب المطرود كان مواطناً (أو دوراً آخر). المحتال فاز!";
                vibrate(500);
            }
        };

        const prepareSpyGuessing = () => {
            const optionsContainer = document.getElementById('spy-word-options');
            optionsContainer.innerHTML = '';
            document.getElementById('spy-confirm-btn').disabled = true;

            // Get category words
            let pool = wordDatabase;
            if (gameState.category !== 'all') {
                pool = wordDatabase.filter(w => w.cat === gameState.category);
            }

            // Pick 11 random words + the correct original word
            let options = new Set([gameState.originalWord]);
            while (options.size < Math.min(12, pool.length * 2)) {
                const pair = pool[Math.floor(Math.random() * pool.length)];
                options.add(pair.w1);
                options.add(pair.w2);
            }

            let finalOptions = Array.from(options).slice(0, 12).sort(() => Math.random() - 0.5);

            finalOptions.forEach(word => {
                const chip = document.createElement('div');
                chip.className = 'chip';
                chip.innerText = word;
                chip.onclick = () => {
                    document.querySelectorAll('#spy-word-options .chip').forEach(c => c.classList.remove('active'));
                    chip.classList.add('active');
                    gameState.spyChoice = word;
                    document.getElementById('spy-confirm-btn').disabled = false;
                    playSfx('click');
                };
                optionsContainer.appendChild(chip);
            });
            showScreen('screen-spy-guess');
        };

        const showResults = () => {
            showScreen('screen-results');
            document.getElementById('res-original-word').innerText = gameState.originalWord;

            const fakeWordGroup = document.getElementById('res-fake-word-group');
            if (gameState.mode === 'hard') {
                document.getElementById('res-fake-word').innerText = gameState.fakeWord;
                fakeWordGroup.style.display = 'block';
            } else {
                fakeWordGroup.style.display = 'none';
            }

            const votedPlayer = gameState.players.find(p => p.id === gameState.votedOutId);
            let imposterCaught = (votedPlayer && votedPlayer.role === 'imposter');
            let spyExists = gameState.players.some(p => p.role === 'spy');

            // Determine winners
            if (!imposterCaught) {
                gameState.winnerTitle = "فوز المحتال!";
                gameState.winnerSubtitle = "لم يتمكن المواطنون من اكتشاف المحتال.";
            } else if (imposterCaught && spyExists && gameState.spyChoice === gameState.originalWord) {
                gameState.winnerTitle = "فوز الجاسوس!";
                gameState.winnerSubtitle = "الجاسوس عرف الكلمة الصحيحة وسرق الفوز!";
            } else if (imposterCaught && spyExists && gameState.spyChoice !== gameState.originalWord) {
                gameState.winnerTitle = "فوز المواطنين!";
                gameState.winnerSubtitle = "تم كشف المحتال، وفشل الجاسوس في تخمين الكلمة.";
            } else {
                gameState.winnerTitle = "فوز المواطنين!";
                gameState.winnerSubtitle = "تم كشف المحتال بنجاح!";
            }

            document.getElementById('win-title').innerText = gameState.winnerTitle;
            document.getElementById('win-subtitle').innerText = gameState.winnerSubtitle;

            if (gameState.winnerTitle.includes("المواطنين")) {
                document.getElementById('win-title').style.color = "var(--primary-light)";
                playSfx('win');
            } else if (gameState.winnerTitle.includes("الجاسوس")) {
                document.getElementById('win-title').style.color = "#10b981";
                playSfx('win');
            } else {
                document.getElementById('win-title').style.color = "var(--secondary)";
            }

            const list = document.getElementById('results-list');
            list.innerHTML = '';
            gameState.players.forEach(p => {
                const item = document.createElement('div');
                item.className = `res-item ${p.role === 'imposter' ? 'imposter' : ''}`;

                let roleName = 'مواطن';
                if (p.role === 'imposter') roleName = 'محتال';
                if (p.role === 'spy') roleName = 'جاسوس';
                if (p.role === 'blind') roleName = 'أعمى';

                item.innerHTML = `
                    <div>
                        <span class="p-num">اللاعب ${p.id}</span>
                        <div class="p-name">${roleName}</div>
                    </div>
                    <div class="p-wrd">${p.word}</div>
                `;
                list.appendChild(item);
            });
        };

        const updateTimerDisplay = () => {
            const timerEl = document.getElementById('discussion-timer');
            const mins = Math.floor(gameState.discussionTimeRemaining / 60).toString().padStart(2, '0');
            const secs = (gameState.discussionTimeRemaining % 60).toString().padStart(2, '0');
            timerEl.innerText = `${mins}:${secs}`;

            if (gameState.discussionTimeRemaining <= 10 && gameState.discussionTimeRemaining > 0) {
                if (!timerEl.classList.contains('warning')) {
                    timerEl.classList.add('warning');
                    timerEl.classList.remove('running');
                }
            } else {
                timerEl.classList.remove('warning');
            }
        };

        const returnToHome = () => {
            playSfx('home');
            vibrate([50, 50]);

            // Clear any active timers
            clearTimeout(gameState.revealTimer);
            clearInterval(gameState.discussionTimerInterval);

            // Reset UI
            document.getElementById('home-btn').classList.add('hidden');
            const timerDisplay = document.getElementById('discussion-timer');
            if (timerDisplay) {
                timerDisplay.classList.remove('running', 'warning');
            }

            // Hide the reveal card back if it was flipped
            const card = document.getElementById('reveal-card');
            if (card) {
                card.classList.remove('flipped');
                const pulseIcon = document.querySelector('.pulse-icon');
                if (pulseIcon) pulseIcon.style.display = 'flex';
            }

            // Go back to start screen
            showScreen('screen-start');
        };

        // --- Event Listeners ---

        // Setup Screen
        document.getElementById('time-slider').addEventListener('input', (e) => {
            gameState.discussionTime = parseInt(e.target.value);
            document.getElementById('time-value').innerText = e.target.value + 'ث';
        });

        document.getElementById('players-slider').addEventListener('input', (e) => {
            gameState.numPlayers = e.target.value;
            document.getElementById('players-value').innerText = e.target.value;
            const impSlider = document.getElementById('imposters-slider');
            impSlider.max = Math.max(1, gameState.numPlayers - 1);
            if (parseInt(impSlider.value) > impSlider.max) {
                impSlider.value = impSlider.max;
                document.getElementById('imposters-value').innerText = impSlider.value;
            }
        });

        document.getElementById('imposters-slider').addEventListener('input', (e) => {
            gameState.numImposters = e.target.value;
            document.getElementById('imposters-value').innerText = e.target.value;
        });

        document.querySelectorAll('[data-mode]').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('[data-mode]').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                gameState.mode = btn.getAttribute('data-mode');
                playSfx('click');
            });
        });

        document.querySelectorAll('[data-cat]').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('[data-cat]').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                gameState.category = btn.getAttribute('data-cat');
                playSfx('click');
            });
        });

        document.getElementById('start-btn').addEventListener('click', () => {
            playSfx('click');
            vibrate(100);
            initGame();
        });

        // Pass Phone Screen
        document.getElementById('im-ready-btn').addEventListener('click', () => {
            playSfx('click');
            showScreen('screen-reveal');
            resetRevealScreen();
        });

        // Reveal Screen
        const resetRevealScreen = () => {
            clearTimeout(gameState.revealTimer);
            document.getElementById('reveal-card').classList.remove('flipped');
            document.getElementById('role-category').innerText = '';
            document.getElementById('role-initial-text').innerText = "اضغط للقلب";
            document.getElementById('reveal-instruction').innerText = "انقر للقلب والكشف عن دورك";
            document.getElementById('done-reveal-btn').classList.add('hidden');

            // Re-show front pulse icon
            const pulseIcon = document.querySelector('.pulse-icon');
            if (pulseIcon) pulseIcon.style.display = 'flex';
        };

        document.getElementById('reveal-card').addEventListener('click', () => {
            const card = document.getElementById('reveal-card');
            if (card.classList.contains('flipped')) return; // already revealed

            // Hide the pulse icon on the front
            const pulseIcon = document.querySelector('.pulse-icon');
            if (pulseIcon) pulseIcon.style.display = 'none';

            // Flip the card
            card.classList.add('flipped');

            const player = gameState.players[gameState.currentPlayerIdx];
            const wordEl = document.getElementById('role-word');
            const catEl = document.getElementById('role-category');
            const subEl = document.getElementById('role-subtext');

            const pair = wordDatabase.find(p => p.w1 === gameState.originalWord || p.w2 === gameState.originalWord);
            catEl.innerText = `${categoryNames[pair.cat] || 'عام'}`;

            wordEl.className = 'role-word word-anim';
            const descEl = document.getElementById('role-word-desc');
            if (descEl) {
                descEl.innerText = '';
                descEl.style.display = 'none';
            }

            if (player.role === 'imposter' && gameState.mode === 'classic') {
                wordEl.classList.add('imposter-text');
                vibrate([50, 50, 50]);
            } else if (player.role === 'spy') {
                wordEl.classList.add('spy-text');
                vibrate([100, 50]);
            } else if (player.role === 'blind') {
                wordEl.classList.add('blind-text');
                vibrate(50);
            } else {
                vibrate(50);
                if (descEl) {
                    if (pair.w1 === player.word) {
                        descEl.innerText = pair.d1;
                        descEl.style.display = 'block';
                    } else if (pair.w2 === player.word) {
                        descEl.innerText = pair.d2;
                        descEl.style.display = 'block';
                    }
                }
            }

            wordEl.innerText = player.word;
            if (player.subtext) {
                subEl.innerText = player.subtext;
                subEl.style.display = 'block';
            } else {
                subEl.style.display = 'none';
            }

            playSfx('reveal');

            // Auto Hide Anti-Cheat
            gameState.revealTimer = setTimeout(() => {
                card.classList.remove('flipped');
                document.getElementById('role-initial-text').innerText = "تم الإخفاء";
                document.getElementById('reveal-instruction').innerText = "انتهى الوقت";
                document.getElementById('done-reveal-btn').classList.remove('hidden');
            }, 3000);
        });

        document.getElementById('done-reveal-btn').addEventListener('click', () => {
            playSfx('click');
            nextPlayer();
        });

        // Game/Voting
        document.getElementById('start-timer-btn').addEventListener('click', () => {
            playSfx('submit');

            const timerDisplay = document.getElementById('discussion-timer');
            timerDisplay.classList.add('running');
            document.getElementById('start-timer-btn').disabled = true;
            document.getElementById('stop-timer-btn').disabled = false;

            clearInterval(gameState.discussionTimerInterval);

            gameState.discussionTimerInterval = setInterval(() => {
                gameState.discussionTimeRemaining--;
                updateTimerDisplay();

                if (gameState.discussionTimeRemaining > 0 && gameState.discussionTimeRemaining <= 10) {
                    playSfx('tick');
                }

                if (gameState.discussionTimeRemaining <= 0) {
                    clearInterval(gameState.discussionTimerInterval);
                    playSfx('timeout');
                    vibrate([200, 100, 200]);
                    timerDisplay.classList.remove('running', 'warning');
                    document.getElementById('start-timer-btn').disabled = false;
                    document.getElementById('stop-timer-btn').disabled = true;
                }
            }, 1000);
        });

        document.getElementById('stop-timer-btn').addEventListener('click', () => {
            playSfx('click');
            clearInterval(gameState.discussionTimerInterval);
            document.getElementById('start-timer-btn').disabled = false;
            document.getElementById('stop-timer-btn').disabled = true;
            document.getElementById('discussion-timer').classList.remove('running', 'warning');
        });

        document.getElementById('start-voting-btn').addEventListener('click', () => {
            playSfx('click');
            clearInterval(gameState.discussionTimerInterval); // Stop timer before leaving
            buildVotingList();
            showScreen('screen-voting');
        });

        document.getElementById('confirm-vote-btn').addEventListener('click', () => {
            playSfx('click');
            showVotingReveal();
        });

        document.getElementById('next-phase-btn').addEventListener('click', () => {
            playSfx('click');
            const votedPlayer = gameState.players.find(p => p.id === gameState.votedOutId);
            const spyExists = gameState.players.some(p => p.role === 'spy');

            if (votedPlayer.role === 'imposter' && spyExists) {
                prepareSpyGuessing();
            } else {
                showResults();
            }
        });

        // Spy Guessing
        document.getElementById('spy-confirm-btn').addEventListener('click', () => {
            playSfx('click');
            showResults();
        });

        document.getElementById('restart-btn').addEventListener('click', () => {
            playSfx('click');
            document.getElementById('home-btn').classList.add('hidden');
            showScreen('screen-start');
        });

        document.getElementById('home-btn').addEventListener('click', returnToHome);

    </script>
</body>

</html>
